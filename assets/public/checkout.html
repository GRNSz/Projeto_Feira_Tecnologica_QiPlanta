<html>
    <head>
      <script src="https://sdk.mercadopago.com/js/v2"></script>
    </head>
    <body>
      <div id="cardPaymentBrick_container"></div>
      <script>
        const mp = new MercadoPago('TEST-f7adf0d0-09ed-4fff-b581-1ef88659cc5e', {
          locale: 'pt-BR'
        });
        const bricksBuilder = mp.bricks();

        const renderCardPaymentBrick = async () => {
          const settings = {
            initialization: {
              amount: 100, // valor total a ser pago
              payer: {
                email: "",
              },
            },
            customization: {
              visual: {
                style: {
                  customVariables: {
                    theme: 'default', // ou 'dark', 'bootstrap', etc.
                  }
                }
              },
              paymentMethods: {
                maxInstallments: 1,
              }
            },
            callbacks: {
              onReady: () => {
                // callback chamado quando o Brick estiver pronto
              },
              onSubmit: (cardFormData) => {
                return new Promise((resolve, reject) => {
                  fetch("/process_payment", {
                    method: "POST",
                    headers: {
                      "Content-Type": "application/json",
                    },
                    body: JSON.stringify(cardFormData)
                  })
                    .then((response) => {
                      resolve();
                    })
                    .catch((error) => {
                      reject();
                    });
                });
              },
              onError: (error) => {
                console.error(error);
              },
            },
          };
          window.cardPaymentBrickController = await bricksBuilder.create('cardPayment', 'cardPaymentBrick_container', settings);
        };
        
        renderCardPaymentBrick();
      </script>
    </body>
</html>
